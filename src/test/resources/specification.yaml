id: shopping-cart-validation
criteria:
  # Query criteria (type: query)
  - type: query
    id: minimum-order-value
    query: {order: {total: {$gte: 25.00}}}

  - type: query
    id: customer-verified
    query: {customer: {verified: true}}

  - type: query
    id: shipping-eligible
    query: {order: {shipping: {country: {$in: [US, CA, UK, AU]}}}}

  - type: query
    id: items-in-stock
    query: {order: {items: {$elemMatch: {in_stock: true}}}}

  # Composite criterion (type: composite) - replaces criteriaGroups
  - type: composite
    id: express-shipping-eligibility
    junction: AND
    criteria:
      # Reference existing criteria (type: reference)
      - type: reference
        id: minimum-order-value

      - type: reference
        id: customer-verified

      - type: reference
        id: shipping-eligible

      # Inline query criterion
      - type: query
        id: prime-member
        query: {customer: {membership: {$eq: PRIME}}}
