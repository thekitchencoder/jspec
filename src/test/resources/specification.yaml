id: shopping-cart-validation
criteria:
  # Query criteria
  - id: minimum-order-value
    query: {order: {total: {$gte: 25.00}}}

  - id: customer-verified
    query: {customer: {verified: true}}

  - id: shipping-eligible
    query: {order: {shipping: {country: {$in: [US, CA, UK, AU]}}}}

  - id: items-in-stock
    query: {order: {items: {$elemMatch: {in_stock: true}}}}

  # Composite criterion - replaces criteriaGroups
  - id: express-shipping-eligibility
    junction: AND
    criteria:
      # Reference existing criteria
      - ref: minimum-order-value

      - ref: customer-verified

      - ref: shipping-eligible

      # Inline query criterion
      - id: prime-member
        query: {customer: {membership: {$eq: PRIME}}}
